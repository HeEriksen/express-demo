<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Draw cards</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" type="image/x-icon" href="./img/favicon.ico" />
    <script src="scripts.mjs" defer></script>
  </head>
  <body>
    <h1>Draw a card!</h1>
    <button id="newDeck">New Deck</button>
    <button id="shuffle">Shuffle</button>
    <button id="showDeck">Show deck</button>
    <button id="drawCard">Draw Card</button>
    <div id="viewContainer"></div>
    <script>
      const viewContainer = document.getElementById("viewContainer");
      let currentDeckId = null;

      document.getElementById("newDeck").onclick = async () => {
        let url = "/temp/deck";
        let resp = await fetch(url, { method: "POST" });
        resp = await resp.json();

        console.log(resp);
        currentDeckId = resp.id;
        viewContainer.innerHTML =
          "<p>You created a new deck!</p>";
      };

      //TODO: Lag if-test pÃ¥ om vi har kortstokk
      document.getElementById("shuffle").onclick = async () => {
        let url = `/temp/deck/shuffle/${currentDeckId}`;
        let resp = await fetch(url, { method: "PATCH" });
        resp = await resp.json();

        console.log(resp);
        viewContainer.innerHTML = "<p>Deck has been shuffled!<p>";
      };

      document.getElementById("showDeck").onclick = async () => {
        let url = `/temp/deck/${currentDeckId}`;
        let resp = await fetch(url, { method: "GET" });
        resp = await resp.json();

        console.log(resp);
        viewContainer.innerHTML = 
        `<p>The cards left in your deck:</p>
        <ul>${resp.map(card => `<li>${card.value} of ${card.suit}</li>`).join('')}</ul> `;
      };

      document.getElementById("drawCard").onclick = async () => {
        let url = `/temp/deck/${currentDeckId}/card`;
        let resp = await fetch(url, { method: "GET" });
        let data = await resp.json();

        console.log(data);
        viewContainer.innerHTML = `You drew the ${data.value} of ${data.suit}`;
      };
    </script>
  </body>
</html>
